comorbilidades_freq %>%
ggplot(aes(x=comorbilidad, y=porcentaje)) +
geom_bar(stat="identity", colour="black", fill="steelblue", width = 0.3) +
theme_light()
covid.data %>%
filter(RESULTADO == "Positivo SARS-CoV-2" & TIPO_PACIENTE == "HOSPITALIZADO") %>%
select(OTRO_CASO) %>%
data.matrix() %>%
mean()
covid.data %>%
filter(RESULTADO == "Positivo SARS-CoV-2" & TIPO_PACIENTE == "HOSPITALIZADO") %>%
select(OTRO_CASO) %>%
data.matrix() %>%
mean()
comorbilidades_freq <- tribble(
~comorbilidad,         ~porcentaje,
"DIABETES", 0.3,
"EPOC", 0.038,
"ASMA", 0.023,
"INMUSUPR", 0.026,
"HIPERTENSION", 0.33,
"OTRAS_COM", 0.042,
"CARDIOVASCULAR", 0.042,
"OBESIDAD", 0.24,
"RENAL_CRONICA", 0.046,
"TABAQUISMO", 0.086,
"OTRO_CASO", 0.14
)
comorbilidades_freq %>%
ggplot(aes(x=comorbilidad, y=porcentaje)) +
geom_bar(stat="identity", colour="black", fill="steelblue", width = 0.3) +
theme_light()
comorbilidades_freq %>%
ggplot(aes(x=comorbilidad, y=porcentaje)) +
geom_bar(stat="identity", colour="black", fill="steelblue", width = 0.3) +
theme_light() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
comorbilidades_freq %>%
ggplot(aes(x=reorder(comorbilidad, porcentaje), y=porcentaje)) +
geom_bar(stat="identity", colour="black", fill="steelblue", width = 0.3) +
theme_light() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
comorbilidades_freq %>%
ggplot(aes(x=reorder(comorbilidad, -porcentaje), y=porcentaje)) +
geom_bar(stat="identity", colour="black", fill="steelblue", width = 0.3) +
theme_light() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
comorbilidades_freq %>%
ggplot(aes(x=reorder(comorbilidad, -porcentaje), y=porcentaje)) +
geom_bar(stat="identity", colour="black", fill="steelblue", width = 0.3) +
theme_light() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(x = "Comorbilidad")
comorbilidades_freq %>%
ggplot(aes(x=reorder(comorbilidad, -porcentaje), y=porcentaje)) +
geom_bar(stat="identity", colour="black", fill="steelblue", width = 0.3) +
theme_light() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(x = "Comorbilidad") +
labs(y = "Porcentaje")
covid.data %>%
filter(RESULTADO == "Positivo SARS-CoV-2" & TIPO_PACIENTE == "HOSPITALIZADO") %>%
select(NEUMONIA) %>%
data.matrix() %>%
mean()
OTRO_CASO
covid.data %>%
filter(RESULTADO == "Positivo SARS-CoV-2" & TIPO_PACIENTE == "HOSPITALIZADO") %>%
select(OTRO_CASO) %>%
data.matrix() %>%
mean()
covid.data = covid.data %>%
mutate(FALLECIDO = if_else(is.na(FECHA_DEF), 0, 1))
library(tidymodels)
train_test_split <- initial_split(covid.data)
covid.train <- training(train_test_split)
covid.test <- testing(train_test_split)
View(covid.train)
covid.data = read_csv("data/200531COVID19MEXICO.csv")
entidad.catalogo = read_csv("data/Catalogo_entidades.csv") %>% select(-ABREVIATURA)
municipio.catalogo = read_csv("data/Catalogo_municipios.csv")
origen.catalogo = read_csv("data/Catalogo_origen.csv")
sector.catalogo = read_csv("data/Catalogo_sector.csv")
sexo.catalogo = read_csv("data/Catalogo_sexo.csv")
tipo.paciente.catalogo = read_csv("data/Catalogo_tipo_paciente.csv")
bool.catalogo = read_csv("data/Catalogo_si_no.csv")
nacionalidad.catalogo = read_csv("data/Catalogo_nacionalidad.csv")
resultado.catalogo = read_csv("data/Catalogo_resultado.csv")
# Expand "ENTIDAD_UM"
covid.data = covid.data %>%
inner_join(entidad.catalogo, by = c("ENTIDAD_UM" = "CLAVE_ENTIDAD"), copy = FALSE) %>%
select(-ENTIDAD_UM) %>%
rename(ENTIDAD_UM = ENTIDAD_FEDERATIVA)
# Expand "ENTIDAD_NAC"
covid.data = covid.data %>%
inner_join(entidad.catalogo, by = c("ENTIDAD_NAC" = "CLAVE_ENTIDAD"), copy = FALSE) %>%
select(-ENTIDAD_NAC) %>%
rename(ENTIDAD_NAC = ENTIDAD_FEDERATIVA)
# Expand "MUNICIPIO_RES"
covid.data = covid.data %>%
inner_join(municipio.catalogo, by = c("MUNICIPIO_RES" = "CLAVE_MUNICIPIO", "ENTIDAD_RES" = "CLAVE_ENTIDAD"), copy = FALSE) %>%
select(-MUNICIPIO_RES) %>%
rename(MUNICIPIO_RES = MUNICIPIO)
# Expand "ENTIDAD_RES"
covid.data = covid.data %>%
inner_join(entidad.catalogo, by = c("ENTIDAD_RES" = "CLAVE_ENTIDAD"), copy = FALSE) %>%
select(-ENTIDAD_RES) %>%
rename(ENTIDAD_RES = ENTIDAD_FEDERATIVA)
# Expand "ORIGEN"
covid.data = covid.data %>%
inner_join(origen.catalogo, by = c("ORIGEN" = "CLAVE"), copy = FALSE) %>%
select(-ORIGEN) %>%
rename(ORIGEN = DESCRIPCIÓN)
# Expand "SECTOR"
covid.data = covid.data %>%
inner_join(sector.catalogo, by = c("SECTOR" = "CLAVE"), copy = FALSE) %>%
select(-SECTOR) %>%
rename(SECTOR = DESCRIPCIÓN)
# Expand "SEXO"
covid.data = covid.data %>%
inner_join(sexo.catalogo, by = c("SEXO" = "CLAVE"), copy = FALSE) %>%
select(-SEXO) %>%
rename(SEXO = DESCRIPCIÓN)
# Expand "TIPO PACIENTE"
covid.data = covid.data %>%
inner_join(tipo.paciente.catalogo, by = c("TIPO_PACIENTE" = "CLAVE"), copy = FALSE) %>%
select(-TIPO_PACIENTE) %>%
rename(TIPO_PACIENTE = DESCRIPCIÓN)
# Expand "INTUBADO"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("INTUBADO" = "CLAVE"), copy = FALSE) %>%
select(-INTUBADO) %>%
rename(INTUBADO = DESCRIPCIÓN)
# Expand "NEUMONIA"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("NEUMONIA" = "CLAVE"), copy = FALSE) %>%
select(-NEUMONIA) %>%
rename(NEUMONIA = DESCRIPCIÓN)
# Expand "NACIONALIDAD"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("NACIONALIDAD" = "CLAVE"), copy = FALSE) %>%
select(-NACIONALIDAD) %>%
rename(NACIONALIDAD = DESCRIPCIÓN)
# Expand "EMBARAZO"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("EMBARAZO" = "CLAVE"), copy = FALSE) %>%
select(-EMBARAZO) %>%
rename(EMBARAZO = DESCRIPCIÓN)
# Expand "HABLA_LENGUA_INDIG"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("HABLA_LENGUA_INDIG" = "CLAVE"), copy = FALSE) %>%
select(-HABLA_LENGUA_INDIG) %>%
rename(HABLA_LENGUA_INDIG = DESCRIPCIÓN)
# Expand "DIABETES"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("DIABETES" = "CLAVE"), copy = FALSE) %>%
select(-DIABETES) %>%
rename(DIABETES = DESCRIPCIÓN)
# Expand "EPOC"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("EPOC" = "CLAVE"), copy = FALSE) %>%
select(-EPOC) %>%
rename(EPOC = DESCRIPCIÓN)
# Expand "ASMA"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("ASMA" = "CLAVE"), copy = FALSE) %>%
select(-ASMA) %>%
rename(ASMA = DESCRIPCIÓN)
# Expand "INMUSUPR"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("INMUSUPR" = "CLAVE"), copy = FALSE) %>%
select(-INMUSUPR) %>%
rename(INMUSUPR = DESCRIPCIÓN)
# Expand "HIPERTENSION"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("HIPERTENSION" = "CLAVE"), copy = FALSE) %>%
select(-HIPERTENSION) %>%
rename(HIPERTENSION = DESCRIPCIÓN)
# Expand "OTRA_COM"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("OTRA_COM" = "CLAVE"), copy = FALSE) %>%
select(-OTRA_COM) %>%
rename(OTRA_COM = DESCRIPCIÓN)
# Expand "CARDIOVASCULAR"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("CARDIOVASCULAR" = "CLAVE"), copy = FALSE) %>%
select(-CARDIOVASCULAR) %>%
rename(CARDIOVASCULAR = DESCRIPCIÓN)
# Expand "OBESIDAD"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("OBESIDAD" = "CLAVE"), copy = FALSE) %>%
select(-OBESIDAD) %>%
rename(OBESIDAD = DESCRIPCIÓN)
# Expand "RENAL_CRONICA"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("RENAL_CRONICA" = "CLAVE"), copy = FALSE) %>%
select(-RENAL_CRONICA) %>%
rename(RENAL_CRONICA = DESCRIPCIÓN)
# Expand "TABAQUISMO"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("TABAQUISMO" = "CLAVE"), copy = FALSE) %>%
select(-TABAQUISMO) %>%
rename(TABAQUISMO = DESCRIPCIÓN)
# Expand "OTRO_CASO"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("OTRO_CASO" = "CLAVE"), copy = FALSE) %>%
select(-OTRO_CASO) %>%
rename(OTRO_CASO = DESCRIPCIÓN)
# Expand "RESULTADO"
covid.data = covid.data %>%
inner_join(resultado.catalogo, by = c("RESULTADO" = "CLAVE"), copy = FALSE) %>%
select(-RESULTADO) %>%
rename(RESULTADO = DESCRIPCIÓN)
# Expand "MIGRANTE"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("MIGRANTE" = "CLAVE"), copy = FALSE) %>%
select(-MIGRANTE) %>%
rename(MIGRANTE = DESCRIPCIÓN)
# Expand "UCI"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("UCI" = "CLAVE"), copy = FALSE) %>%
select(-UCI) %>%
rename(UCI = DESCRIPCIÓN)
covid.data = covid.data %>%
mutate(DIABETES = ifelse(DIABETES == "SI", 1.0, 0.0)) %>%
mutate(EPOC = ifelse(EPOC == "SI", 1.0, 0.0)) %>%
mutate(ASMA = ifelse(ASMA == "SI", 1.0, 0.0)) %>%
mutate(INMUSUPR = ifelse(INMUSUPR == "SI", 1.0, 0.0)) %>%
mutate(HIPERTENSION = ifelse(HIPERTENSION == "SI", 1.0, 0.0)) %>%
mutate(OTRA_COM = ifelse(OTRA_COM == "SI", 1, 0)) %>%
mutate(CARDIOVASCULAR = ifelse(CARDIOVASCULAR == "SI", 1.0, 0.0)) %>%
mutate(OBESIDAD = ifelse(OBESIDAD == "SI", 1, 0)) %>%
mutate(RENAL_CRONICA = ifelse(RENAL_CRONICA == "SI", 1.0, 0.0)) %>%
mutate(TABAQUISMO = ifelse(TABAQUISMO == "SI", 1.0, 0.0)) %>%
mutate(OTRO_CASO = ifelse(OTRO_CASO == "SI", 1.0, 0.0)) %>%
mutate(INTUBADO = ifelse(OTRO_CASO == "SI", 1.0, 0.0)) %>%
mutate(NEUMONIA = ifelse(OTRO_CASO == "SI", 1.0, 0.0))
covid.data = covid.data %>%
mutate(FALLECIDO = if_else(is.na(FECHA_DEF), 0, 1))
---------------------
# Logistic Regression
---------------------
# Se busca modelar la probabilidad de que un paciente fallezca
# y buscar que variables son más informativas para la modelación
set.seed(55)
train_test_split <- initial_split(covid.data)
covid.train <- training(train_test_split)
covid.test <- testing(train_test_split)
---------------------
# Logistic Regression
---------------------
# Se busca modelar la probabilidad de que un paciente fallezca
# y buscar que variables son más informativas para la modelación
set.seed(55)
---------------------
# Logistic Regression
---------------------
# Se busca modelar la probabilidad de que un paciente fallezca
# y buscar que variables son más informativas para la modelación
set.seed(42)
set.seed()
set.seed()1
set.seed(1)
set.seed(42)
---------------------
# Logistic Regression
---------------------
# Se busca modelar la probabilidad de que un paciente fallezca
# y buscar que variables son más informativas para la modelación
set.seed(42)
---------------------
# Logistic Regression
---------------------
# Se busca modelar la probabilidad de que un paciente fallezca
# y buscar que variables son más informativas para la modelación
set.seed(1)
---------------------
# Logistic Regression
---------------------
# Se busca modelar la probabilidad de que un paciente fallezca
# y buscar que variables son más informativas para la modelación
set.seed(42)
---------------------
# Logistic Regression
---------------------
# Se busca modelar la probabilidad de que un paciente fallezca
# y buscar que variables son más informativas para la modelación
set.seed(42)
set.seed(1)
set.seed(42)
train_test_split <- initial_split(covid.data)
covid.train <- training(train_test_split)
covid.test <- testing(train_test_split)
covid.recipe = recipe(FALLECIDO ~ EDAD + INTUBADO + NEUMONIA + DIABETES
+ EPOC + ASMA + INMUSUPR + HIPERTENSION + OTRA_COM +
CARDIOVASCULAR + OBESIDAD + RENAL_CRONICA + TABAQUISMO +
OTRO_CASO, data = covid.train)
covid.recipe
ssummary(covid.recipe)
summary(covid.recipe)
model.recipe.steps = covid.recipe
model.recipe.steps = covid.recipe
prepped.recipe <- prep(model.recipe.steps, training = covid.train)
covid.train.prep = bake(prepped_recipe, covid.train)
covid.train.prep = bake(prepped.recipe, covid.train)
covid.test.prep = bake(prepped.recipe, covid.test)
View(covid.train.prep)
covid.lr.model = logistic_reg(mode = "classification") %>%
set_engine("glm") %>%
fit(FALLECIDO ~ EDAD + INTUBADO + NEUMONIA + DIABETES
+ EPOC + ASMA + INMUSUPR + HIPERTENSION + OTRA_COM +
CARDIOVASCULAR + OBESIDAD + RENAL_CRONICA + TABAQUISMO +
OTRO_CASO, data = covid.train.prep)
model.recipe.steps = covid.recipe %>%
step_num2factor(FALLECIDO)
covid.data = read_csv("data/200531COVID19MEXICO.csv")
entidad.catalogo = read_csv("data/Catalogo_entidades.csv") %>% select(-ABREVIATURA)
municipio.catalogo = read_csv("data/Catalogo_municipios.csv")
origen.catalogo = read_csv("data/Catalogo_origen.csv")
sector.catalogo = read_csv("data/Catalogo_sector.csv")
sexo.catalogo = read_csv("data/Catalogo_sexo.csv")
tipo.paciente.catalogo = read_csv("data/Catalogo_tipo_paciente.csv")
bool.catalogo = read_csv("data/Catalogo_si_no.csv")
nacionalidad.catalogo = read_csv("data/Catalogo_nacionalidad.csv")
resultado.catalogo = read_csv("data/Catalogo_resultado.csv")
# Expand "ENTIDAD_UM"
covid.data = covid.data %>%
inner_join(entidad.catalogo, by = c("ENTIDAD_UM" = "CLAVE_ENTIDAD"), copy = FALSE) %>%
select(-ENTIDAD_UM) %>%
rename(ENTIDAD_UM = ENTIDAD_FEDERATIVA)
# Expand "ENTIDAD_NAC"
covid.data = covid.data %>%
inner_join(entidad.catalogo, by = c("ENTIDAD_NAC" = "CLAVE_ENTIDAD"), copy = FALSE) %>%
select(-ENTIDAD_NAC) %>%
rename(ENTIDAD_NAC = ENTIDAD_FEDERATIVA)
# Expand "MUNICIPIO_RES"
covid.data = covid.data %>%
inner_join(municipio.catalogo, by = c("MUNICIPIO_RES" = "CLAVE_MUNICIPIO", "ENTIDAD_RES" = "CLAVE_ENTIDAD"), copy = FALSE) %>%
select(-MUNICIPIO_RES) %>%
rename(MUNICIPIO_RES = MUNICIPIO)
# Expand "ENTIDAD_RES"
covid.data = covid.data %>%
inner_join(entidad.catalogo, by = c("ENTIDAD_RES" = "CLAVE_ENTIDAD"), copy = FALSE) %>%
select(-ENTIDAD_RES) %>%
rename(ENTIDAD_RES = ENTIDAD_FEDERATIVA)
# Expand "ORIGEN"
covid.data = covid.data %>%
inner_join(origen.catalogo, by = c("ORIGEN" = "CLAVE"), copy = FALSE) %>%
select(-ORIGEN) %>%
rename(ORIGEN = DESCRIPCIÓN)
# Expand "SECTOR"
covid.data = covid.data %>%
inner_join(sector.catalogo, by = c("SECTOR" = "CLAVE"), copy = FALSE) %>%
select(-SECTOR) %>%
rename(SECTOR = DESCRIPCIÓN)
# Expand "SEXO"
covid.data = covid.data %>%
inner_join(sexo.catalogo, by = c("SEXO" = "CLAVE"), copy = FALSE) %>%
select(-SEXO) %>%
rename(SEXO = DESCRIPCIÓN)
# Expand "TIPO PACIENTE"
covid.data = covid.data %>%
inner_join(tipo.paciente.catalogo, by = c("TIPO_PACIENTE" = "CLAVE"), copy = FALSE) %>%
select(-TIPO_PACIENTE) %>%
rename(TIPO_PACIENTE = DESCRIPCIÓN)
# Expand "INTUBADO"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("INTUBADO" = "CLAVE"), copy = FALSE) %>%
select(-INTUBADO) %>%
rename(INTUBADO = DESCRIPCIÓN)
# Expand "NEUMONIA"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("NEUMONIA" = "CLAVE"), copy = FALSE) %>%
select(-NEUMONIA) %>%
rename(NEUMONIA = DESCRIPCIÓN)
# Expand "NACIONALIDAD"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("NACIONALIDAD" = "CLAVE"), copy = FALSE) %>%
select(-NACIONALIDAD) %>%
rename(NACIONALIDAD = DESCRIPCIÓN)
# Expand "EMBARAZO"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("EMBARAZO" = "CLAVE"), copy = FALSE) %>%
select(-EMBARAZO) %>%
rename(EMBARAZO = DESCRIPCIÓN)
# Expand "HABLA_LENGUA_INDIG"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("HABLA_LENGUA_INDIG" = "CLAVE"), copy = FALSE) %>%
select(-HABLA_LENGUA_INDIG) %>%
rename(HABLA_LENGUA_INDIG = DESCRIPCIÓN)
# Expand "DIABETES"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("DIABETES" = "CLAVE"), copy = FALSE) %>%
select(-DIABETES) %>%
rename(DIABETES = DESCRIPCIÓN)
# Expand "EPOC"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("EPOC" = "CLAVE"), copy = FALSE) %>%
select(-EPOC) %>%
rename(EPOC = DESCRIPCIÓN)
# Expand "ASMA"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("ASMA" = "CLAVE"), copy = FALSE) %>%
select(-ASMA) %>%
rename(ASMA = DESCRIPCIÓN)
# Expand "INMUSUPR"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("INMUSUPR" = "CLAVE"), copy = FALSE) %>%
select(-INMUSUPR) %>%
rename(INMUSUPR = DESCRIPCIÓN)
# Expand "HIPERTENSION"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("HIPERTENSION" = "CLAVE"), copy = FALSE) %>%
select(-HIPERTENSION) %>%
rename(HIPERTENSION = DESCRIPCIÓN)
# Expand "OTRA_COM"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("OTRA_COM" = "CLAVE"), copy = FALSE) %>%
select(-OTRA_COM) %>%
rename(OTRA_COM = DESCRIPCIÓN)
# Expand "CARDIOVASCULAR"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("CARDIOVASCULAR" = "CLAVE"), copy = FALSE) %>%
select(-CARDIOVASCULAR) %>%
rename(CARDIOVASCULAR = DESCRIPCIÓN)
# Expand "OBESIDAD"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("OBESIDAD" = "CLAVE"), copy = FALSE) %>%
select(-OBESIDAD) %>%
rename(OBESIDAD = DESCRIPCIÓN)
# Expand "RENAL_CRONICA"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("RENAL_CRONICA" = "CLAVE"), copy = FALSE) %>%
select(-RENAL_CRONICA) %>%
rename(RENAL_CRONICA = DESCRIPCIÓN)
# Expand "TABAQUISMO"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("TABAQUISMO" = "CLAVE"), copy = FALSE) %>%
select(-TABAQUISMO) %>%
rename(TABAQUISMO = DESCRIPCIÓN)
# Expand "OTRO_CASO"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("OTRO_CASO" = "CLAVE"), copy = FALSE) %>%
select(-OTRO_CASO) %>%
rename(OTRO_CASO = DESCRIPCIÓN)
# Expand "RESULTADO"
covid.data = covid.data %>%
inner_join(resultado.catalogo, by = c("RESULTADO" = "CLAVE"), copy = FALSE) %>%
select(-RESULTADO) %>%
rename(RESULTADO = DESCRIPCIÓN)
# Expand "MIGRANTE"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("MIGRANTE" = "CLAVE"), copy = FALSE) %>%
select(-MIGRANTE) %>%
rename(MIGRANTE = DESCRIPCIÓN)
# Expand "UCI"
covid.data = covid.data %>%
inner_join(bool.catalogo, by = c("UCI" = "CLAVE"), copy = FALSE) %>%
select(-UCI) %>%
rename(UCI = DESCRIPCIÓN)
covid.data = covid.data %>%
mutate(DIABETES = ifelse(DIABETES == "SI", 1.0, 0.0)) %>%
mutate(EPOC = ifelse(EPOC == "SI", 1.0, 0.0)) %>%
mutate(ASMA = ifelse(ASMA == "SI", 1.0, 0.0)) %>%
mutate(INMUSUPR = ifelse(INMUSUPR == "SI", 1.0, 0.0)) %>%
mutate(HIPERTENSION = ifelse(HIPERTENSION == "SI", 1.0, 0.0)) %>%
mutate(OTRA_COM = ifelse(OTRA_COM == "SI", 1, 0)) %>%
mutate(CARDIOVASCULAR = ifelse(CARDIOVASCULAR == "SI", 1.0, 0.0)) %>%
mutate(OBESIDAD = ifelse(OBESIDAD == "SI", 1, 0)) %>%
mutate(RENAL_CRONICA = ifelse(RENAL_CRONICA == "SI", 1.0, 0.0)) %>%
mutate(TABAQUISMO = ifelse(TABAQUISMO == "SI", 1.0, 0.0)) %>%
mutate(OTRO_CASO = ifelse(OTRO_CASO == "SI", 1.0, 0.0)) %>%
mutate(INTUBADO = ifelse(OTRO_CASO == "SI", 1.0, 0.0)) %>%
mutate(NEUMONIA = ifelse(OTRO_CASO == "SI", 1.0, 0.0))
covid.data = covid.data %>%
mutate(FALLECIDO = if_else(is.na(FECHA_DEF), 0, 1))
View(covid.data)
covid.data = covid.data %>%
mutate(FALLECIDO = if_else(is.na(FECHA_DEF), "0", "1"))
View(covid.data)
model.recipe.steps = covid.recipe %>%
step_num2factor(FALLECIDO)
model.recipe.steps = covid.recipe %>%
step_mutate(FALLECIDO = as.factor(FALLECIDO))
prepped.recipe = prep(model.recipe.steps, training = covid.train)
covid.train.prep = bake(prepped.recipe, covid.train)
covid.test.prep = bake(prepped.recipe, covid.test)
View(covid.train.prep)
covid.lr.model = logistic_reg(mode = "classification") %>%
set_engine("glm") %>%
fit(FALLECIDO ~ EDAD + INTUBADO + NEUMONIA + DIABETES
+ EPOC + ASMA + INMUSUPR + HIPERTENSION + OTRA_COM +
CARDIOVASCULAR + OBESIDAD + RENAL_CRONICA + TABAQUISMO +
OTRO_CASO, data = covid.train.prep)
covid.lr.model %>%
predict(covid.test.prep) %>%
bind_cols(covid.test.prep) %>%
metrics(truth = FALLECIDO, estimate = .pred_class)
covid.lr.model
summary(covid.lr.model)
covid.lr.model
covid.lr.model$fit
covid.lr.model$fit$model
covid.lr.model$fit
covid.lr.model %>%
predict(covid.test.prep) %>%
bind_cols(covid.test.prep) %>%
metrics(truth = FALLECIDO, estimate = .pred_class)
covid.lr.model$fit
summary(covid.lr.model$fit)
summary(covid.lr.model$fit)
summary(covid.lr.model$fit)
